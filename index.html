<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Charcoal + Chalk – Bacon x Bukowski</title>
  <style>
    body {
      font-family: monospace;
      background: #111;
      color: #eee;
      padding: 2rem;
    }
    button {
      margin-right: 1rem;
      padding: 0.6rem 1.2rem;
      font-size: 1rem;
      background: #444;
      color: #fff;
      border: none;
      cursor: pointer;
    }
    #promptOutput {
      margin-top: 2rem;
      white-space: pre-wrap;
    }
    #imageOutput {
      margin-top: 2rem;
      max-width: 100%;
      display: none;
    }
  </style>
</head>
<body>
  <h1>Charcoal + Chalk – Bacon x Bukowski</h1>
  <button onclick="generatePrompt()">Generate Prompt</button>
  <button onclick="generateImage()">Generate Image</button>

  <div id="promptOutput"></div>
  <img id="imageOutput" src="" alt="" />

  <script>
    let currentPrompt = '';

    const scenes = [
      "a typewriter surrounded by cigarette smoke",
      "a figure slumped over a cluttered desk at dawn",
      "a shadow framed in a doorway lit by a flickering bulb",
      "a crumpled poem beside a spilled wine glass",
      "a bookshelf collapsed under the weight of grief",
      "a mirror cracked across a bruised reflection",
      "a subway seat carved with forgotten names",
      "a room filled with Polaroids of strangers",
      "a camera left on a bloodstained table",
      "a stairwell descending into velvet dark",
      "a bar lit only by a neon 'regret'",
      "a mattress on the floor with a revolver and notebook",
      "a window where a woman once stood smoking",
      "a rain-soaked alley filled with broken umbrellas",
      "a bathtub with peeling paint and floating cigarette butts",
      "an abandoned diner booth with a half-empty cup of coffee",
      "a pile of burnt rejection letters in a kitchen sink",
      "a lonely man painting in a basement lit by one bulb",
      "a foggy streetlamp illuminating shattered dreams",
      "a handwritten note nailed to a dying tree"
    ];

    const emotions = [
      "numb resistance",
      "disoriented love",
      "broken defiance",
      "haunted calm",
      "restless isolation",
      "eroded hope",
      "drunken euphoria",
      "bleak comfort",
      "ruthless nostalgia",
      "quiet anguish",
      "bruised determination",
      "lost sincerity",
      "apathetic acceptance",
      "angry vulnerability",
      "aching stillness",
      "cynical awe",
      "raw disappointment",
      "unspeakable longing",
      "confused tenderness",
      "violent regret"
    ];

    const objects = [
      "a pair of cracked glasses",
      "a half-lit cigarette",
      "a journal with torn pages",
      "a dried rose in a shot glass",
      "a dusty bottle of absinthe",
      "a faded photo booth strip",
      "a hotel receipt soaked in gin",
      "a single blood-stained shoe",
      "a worn-out camera",
      "a painting turned to the wall",
      "a corkboard with rejection letters",
      "a coffee cup growing mold",
      "an empty bottle of red wine",
      "a record player stuck in a loop",
      "a burnt pack of matches",
      "a broken alarm clock",
      "a cigarette case with initials etched deep",
      "a crumbling paperback of 'Ham on Rye'",
      "a pen out of ink",
      "a postcard never sent"
    ];

    const quotes = [
      `"Find what you love and let it kill you." – Bukowski`,
      `"We are all born mad. Some remain so." – Bacon`,
      `"What matters most is how well you walk through the fire." – Bukowski`,
      `"I paint to disturb people." – Bacon`,
      `"We're all going to die, all of us, what a circus!" – Bukowski`,
      `"I believe in deeply ordered chaos." – Bacon`,
      `"An intellectual says a simple thing in a hard way. An artist says a hard thing in a simple way." – Bukowski`,
      `"I'm not interested in the logic of happy endings." – Bacon`,
      `"There's a bluebird in my heart that wants to get out." – Bukowski, *Bluebird*`,
      `"The job of the artist is always to deepen the mystery." – Bacon`,
      `"You have to die a few times before you can really live." – Bukowski`,
      `"I think of my art as a form of exorcism." – Bacon`,
      `"Too sensitive to live, too stubborn to die." – Bukowski`,
      `"I wanted to paint the scream more than the horror." – Bacon`,
      `"Some people never go crazy. What truly horrible lives they must lead." – Bukowski`,
      `"I don't believe in optimism. I think it's insane." – Bacon`,
      `"Poetry is what happens when nothing else can." – Bukowski`,
      `"Reality is just a crutch for people who can't handle drugs." – Bukowski`,
      `"My work is the only ground I've ever had to stand on." – Bacon`,
      `"The nights you fight best are when all the weapons are pointed at you." – Bukowski`,
      `"I think of life as meaningless, but we give it meaning." – Bacon`,
      `"There’s something in me that doesn’t work unless I’m on the edge." – Bukowski`,
      `"I was born to hustle roses down the avenues of the dead." – Bukowski`,
      `"My paintings are not violent. They may have caused violence in people, but there is no violence in my paintings." – Bacon`
    ];

    function generatePrompt() {
      const scene = scenes[Math.floor(Math.random() * scenes.length)];
      const emotion = emotions[Math.floor(Math.random() * emotions.length)];
      const object = objects[Math.floor(Math.random() * objects.length)];
      const bukowskiIntensity = Math.floor(Math.random() * 101);
      const baconIntensity = Math.floor(Math.random() * 101);
      const quote = quotes[Math.floor(Math.random() * quotes.length)];
      const includeQuote = Math.random() < 0.7;

      currentPrompt = `A charcoal portrait in the emotional and distorted style of Francis Bacon, fused with the bleak realism of Charles Bukowski's world.\nScene: ${scene}.\nMood: ${emotion}.\nSymbol: ${object}.\nBukowski Intensity: ${bukowskiIntensity}/100.\nBacon Intensity: ${baconIntensity}/100.\n\nUse textures that resemble scratched chalk on dark concrete. Prioritize realism with abstract intensity, evoking the loneliness of late-night confessionals.`;

      if (includeQuote) {
        currentPrompt += `\n\nQuote: ${quote}`;
      }

      document.getElementById("promptOutput").innerText = currentPrompt;
      document.getElementById("imageOutput").style.display = 'none';
      document.getElementById("imageOutput").src = '';
    }

    async function generateImage() {
      if (!currentPrompt) {
        alert("Generate a prompt first!");
        return;
      }

      console.log("Submitting prompt:", currentPrompt); // ⬅️ Add this here

      const response = await fetch("/api/generate-image", {
        method: "POST",
        headers: {
          "Content-Type": "application/json"
        },
        body: JSON.stringify({ prompt: currentPrompt })
      });

      const data = await response.json();
      if (data && data.url) {
        const img = document.getElementById("imageOutput");
        img.src = data.url;
        img.style.display = 'block';
      } else {
        alert("Failed to generate image.");
        console.error(data);
      }
    }

    window.onload = generatePrompt;
  </script>
</body>
</html>
